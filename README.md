# program-analysis-project


## Building and Running

### AFL
Build the AFL container with e.g.:

`docker build -f afl.Dockerfile . -t afl-pa`

Run it on a particular sample file with:

`docker run -e SUT_SRC=Prob16-R12-B3.c -v $(pwd)/out:/out afl-pa`

This will put the results in `$(pwd)/out` on your host machine. The timeout for the run can be specified by overriding the `TIME_LIMIT_SECS` environment variable.

### KLEE

`docker build -f klee.Dockerfile . -t klee-pa`

`docker run -e SUT_SRC=Prob16-R12-B3.c -v $(pwd)/out:/out klee-pa`

### CBMC

`docker build -f cbmc.Dockerfile . -t cbmc-pa`

`docker run -e SUT_SRC=Prob16-R12-B3.c -v $(pwd)/out:/out cbmc-pa`

### TRACERX

`docker build -f tracerx.Dockerfile . -t tracerx-pa`

`docker run -e SUT_SRC=Prob16-R12-B3.c -v $(pwd)/out:/out tracerx-pa`

### LLVM COV
Probably not necessary to do in a Docker container, but this lets us just keep things simple for installation.

`docker build -f llvm-cov.Dockerfile -t llvm-cov-pa .`

To get coverage information, you must mount a volume to `/testcases` with the testcases you want to get the cumulative coverages of. It will output a JSON file with the coverage summary into `/out` which can be ported out with another volume. 

`docker run -v $(pwd)/sample-programs/AFL-VERSION:/testcases -v $(pwd)/out:/out -e SUT_SRC=Wtest27-B15.c llvm-cov-pa`

**Note: in this case I am using the source files as testcases; this makes no sense conceptually, in real life you would point this to testcases generated by e.g. AFL rather than the source files.**

## Experiment

You will need to install a few dependencies for the post-processing from the `requirements.txt` file before running the experiment with e.g. `pip install -r requirements.txt`. 
Also, the Python scripts assume a relatively recent version of Python3.
To run all of the tools on all of the test programs, run `launcher.py` from within the scripts subdirectory.
This will build all of the docker containers, and then run them on all of the test programs at the parallelism of your machine before doing some post processing that outputs some graphs and a CSV file.
The outputs will be in the `./out` subdirectory.
For post-processing to work, you will need to change some of the file permissions of the outputs, which is done by the launcher script, just change the user variable in the script to your local user.
There are various other parameters that can be adjusted, like the length of each trial or the number of trials, also at the top of the launcher script.
The post-processing can be run without running the experiment by setting the `skipExperiment` variable to `True` in the launcher script.

```
cd scripts;
rm -rf ../out/*;
python launcher.py
```

